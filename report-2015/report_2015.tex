% !TeX spellcheck = <none>
\documentclass[11pt,titlepage]{article}

\usepackage[french,american]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{amsmath,amsfonts,amssymb}
\usepackage{graphicx}
\usepackage[a4paper]{geometry}           % See geometry.pdf to learn the layout
%\geometry{landscape}                    % Activate for for rotated page 
                                         % geometry
%\usepackage[parfill]{parskip}           % Activate to begin paragraphs with an
                                         % empty line rather than an indent
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{epstopdf}
\usepackage{color}
\usepackage[tt]{titlepic}
\usepackage{fancyhdr}
\usepackage{secdot}
\usepackage{booktabs}
\usepackage{rotating}

% WD41, LRS/EPFL/PSI ----------------------------------------------------------
\usepackage{multirow}
\usepackage{tabularx}
\usepackage{ragged2e}                      % for '\RaggedRight' macro 
                                           % (allows hyphenation)
\newcolumntype{Y}{>{\RaggedRight\arraybackslash}X}
\usepackage[style=ieee, backend=bibtex]{biblatex}
\usepackage{courier}
\usepackage{caption}
\usepackage{pdfpages}
\bibliography{report_2015.bib}
% -----------------------------------------------------------------------------


\topmargin=-0.45in      
%\evensidemargin=0in     
\oddsidemargin=-0.1in      
\textwidth=6.8in        
\textheight=9.0in     
%\headsep=0.25in         

% Titlepage -------------------------------------------------------------------
\DeclareGraphicsRule{.tif}{png}{.png}{`convert #1 `dirname #1`/`basename #1 .tif`.png}
\titlepic{\includegraphics[width=17cm]{figures/research_plan_pic.pdf}}

\title{\textbf{Annual progress report \textcolor{blue}{2015}}}     %Change Year

\author{\large{\textbf{Damar Wicaksono} }\\\\
\large{\textbf{Prof. Andreas Pautz}} \\\
\large{\textbf{Omar Zerkak}} \\\\\\\
\Large{\textbf{Bayesian Uncertainty Quantification}} \\\\
\Large\textbf{of Physical Models} \\\\
\Large\textbf{in Thermal-Hydraulics System Code}}

\date{03.12.2015}				       %activate to remove date
% -----------------------------------------------------------------------------

\begin{document}

\maketitle

% 2nd Page, Epmty Page --------------------------------------------------------
\pagestyle{empty}
\clearpage\mbox{}\clearpage
% -----------------------------------------------------------------------------

% Top Header ------------------------------------------------------------------
\pagestyle{fancy} \pagenumbering{arabic} \setcounter{page}{1}
\addtolength{\headheight}{\baselineskip}
\newcommand{\ffont}{\fontsize{8}{8}\selectfont}
\lhead{ECOLE DOCTORALE\\ \textit{DOCTORAL SCHOOL}}
\chead{PROGRAMME DOCTORAL EN PHYSIQUE\\ \textit{DOCTORAL PROGRAM IN PHYSICS}}
\rhead{\bfseries\ffont  \includegraphics[width=55pt]{figures/EPFL_LOG.pdf}}
\renewcommand{\headrulewidth}{0.4pt}
% -----------------------------------------------------------------------------
%\textcolor{white}.

\section{Objectives of research}

The objective of the research is to quantify the uncertainty of
physical model parameters implemented in a thermal-hydraulics system code.
The physical models concerned are the ones describing
the phasic interaction (heat and momentum exchange) in a complex
multiphase flow during reactor transient especially for the
\textit{reflood} phase following a loss-of-coolant-accident.
These models are parameterized either by  physical or empirical tuning 
parameters which values are uncertain.

Conforming with the practice of statistical uncertainty propagation widely
adopted in the field of nuclear engineering, probability theory is used to
quantify the uncertainties related to each one of these parameters in a form 
of density function and/or its approximation.
The derivation of this density is posed as an inverse statistical problem
following a bayesian approach as the parameters themselves are not directly
observable.
To this end, a methodology to quantify model uncertainty will be
developed combining probabilistic modeling with available relevant
experimental data taken from various separate effect test facilities.

\section{Work achieved in the past year (state of research)}

\subsection{Global Sensitivity Analysis Methodology for TRACE Reflood Model}

Following the LRS at PSI successfull participation in the OECD/NEA PREMIUM Phase IV Benchmark, where the uncertainty of reflood model parameters in TRACE code were propagated in a blind exercise, the question was posed on how the uncertain parameters are actually affecting the clad temperature prediction during a reflood transient.
This question stimulated the development of a sensitivity analysis methodology for TRACE at the LRS.
The goal of the analysis was to understand the reflood model behavior better through the exploration of the parameter space.
Specifically, it was to quantify \emph{how} and \emph{to what extent} the model output is affected by \emph{simultaneous inputs variations across their range of uncertainties}.
The emphasis on simultaneous variations accross range of uncertainties set a \emph{global} method, that is being adopted in the current development, apart from a \emph{local} one.

The aforementioned goals can be met by decomposing the output variance and computing a set of \emph{global sensitivity} measures. 
These indices, quantify the contribution of the inputs variances to the output variance.
The work achieved during the year focused on the main-effect and total-effect indices.
They quantify the effect of a single parameter variation alone and its total interaction with the other parameters, respectively.
An interacting model is considered to be more complex as it complicates the task of parameter calibration or uncertainty reduction.

This paradigm of \textit{variance-based global sensitivity measure} particulary fits well with the current practice of uncertainty propagation in the field of nuclear engineering thermal-hydraulics.
According to the practice, for a given simulation case, sets of uncertain input parameters values are simulatenously perturbed and randomly generated, and then propagated through the code.
The dispersion (i.e., variance) of the prediction is summarized and reported to establish a notion of reliability in the prediction.

The choice of model output of interest is an important initial step in a sensitivity analysis. Its choice is guided by the selected goal.
In the spirit of model exploration, a more descriptive metric had to be derived to quantify the overall reflood curves variations.
Such description is not straightforward as the curves variations often showed complitaed change in shape stemming from concurrent variation in phase as well as in amplitude (See Fig.~\ref{fig:output}(a) for an illustration).
To tackle such problem, a method based on Functional Data Analysis (FDA) framework was applied.
By applying a \emph{time-warping} transformation, the convoluted phase-amplitude variations were first separated. Then by applying the Karhunen - Lo\`eve (KL) transformation, a few modes of variation were extracted (See Fig.~\ref{fig:output}(b)).
A set of scalar model outputs of interest was then finally derived whic parsimoniously described the overall functional variation of a reflood curves dataset, defined over the time domain.
Preliminary work on the application of FDA for the analysis of reflood simulation was presented at the NUTHOS-10 conference on last December and subsequently included in the proceeding \cite{Wicaksono2014a}.

\begin{figure}[h!]
	\centering
		\includegraphics[width=\textwidth]{figures/modelOutputsOfInterest.png}
	\caption{\textbf{(a)}A typical reflood simulation outputs from uncertainty propagations; \textbf{(b)} Three modes of variations extracted from the reflood curves by using FDA framework}
	\label{fig:output}
\end{figure}

The computation of Sobol' indices involved integrations in high-dimensional input parameter space.
These integrals are estimated by Monte Carlo sampling, equipped with an efficient estimator and a space-filling experimental design.
It is required that TRACE code to be evaluated at various input values.
As the number of code runs (thus computing time) is proportional to number of input parameters, screening analysis using the cheaper Morris method was conducted to screen out non-influential input parameters. It was found that only 10 out of 26 initial inputs were considered to be influential for the temperature transient (shown left). 
These parameters were mainly related to the Dispersed Film Flow Boiling (DFFB) and the spacer grid heat transfer models.
Fig.~\ref{fig:influential} gives an illustration regarding the notion of \emph{influential} parameters.
This implementation and application of the Morris method was also presented at the NUTHOS-10 conference last December\cite{Wicaksono2014b}.
The paper was subsequently awarded one of the best student paper award.

\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.75]{figures/influentialRuns.png}
	\caption{Output variations from uncertainty propagation calculation due to 10 influential parameters (green) vs. 16 non-influential ones (gray)}
	\label{fig:influential}
\end{figure}

A result on variance decomposition on the reduced parameter space is shown in Fig.~\ref{fig:1stpc}.
The TRACE Reflood model was found to relatively additive and non-interacting.
Also, the output variation can be attributed only to a small set of parameters related to the spacer grid and DFFB models. 
The finding were not contrary to the currently held expert judgment on these parameteres importance.
Yet, the analysis was able to \emph{make precise} this judgment quantitatively, demonstrating the value of the method.
The result was presented at the NURETH-16 conference \cite{Wicaksono2015a} and selected as one of the best student papers.

\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.65]{figures/1stPrincipalComponent.png}
	\caption{The decomposition of $1^\textnormal{st}$-principal component describing the variation in temperature ramping; the sum of main-effect indices of $92\%$ indicates a non-interacting model}
	\label{fig:1stpc}
\end{figure}

Nevertheless, when considering the $2^\textnormal{nd}$-principal component, only $32\%$ of the variation is due to the main effect, indicating that parameters interactions are responsible for the variation in the temperature descent phase.
This might become an issue when the parameters have to be calibrated against experimental data around this region because multiple combination of parameters value would yield the same fit.
The structure of this interaction, however, remains unclear.
Therefore, the logical next step is to reveal this structure and a method to estimate $2^\textnormal{nd}$-order sensitivity indices is being implemented to that end.

\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.65]{figures/2ndPrincipalComponent.png}
	\caption{The decomposition of $2^\textnormal{nd}$-principal component describing the variation in temperature ramping; the sum of main-effect indices of $32\%$ and large difference between the main- and total-effect indices, indicate a highly interacting model}
	\label{fig:2ndpc}
\end{figure}

\subsection{Generation of Reflood Facility TRACE Model from CAD Processing Tool} 

The sensitivity of the solution to the nodalization scheme used is a longstanding issue in system thermal-hydraulics modelling.
By developing a nodalization, a complex geometry of a thermal-hydraulic system is practically simplified into a set of interconnected \emph{nodes}, a discretized element defined by its volume and the inlet and outlet flow areas at its faces. 
As the analysists are usually given a great flexibility in developing their own nodalization scheme, a situation where multiple nodalization scheme of a same system gives very different prediction might arise.
Though best-practice suggestions exist, the solution verification can only be empirically established by comparing several nodalization scheme to check how sensitive the prediction is and to exclude (or at least minimized) the user-effect in the model qualification process.

\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.65]{figures/nodalization.png}
	\caption{Representation of a nuclear power plant as a network of interconnected and simplified \emph{nodes}}
	\label{fig:nodalization}
\end{figure}

The adopted approach to develop nodalization in this project so far was using spreadsheet. 
Though easy to set up initially, it becomes cumbersome and error prone, especially if several nodalization schemes are to be prepared.
An additional activity was thus carried out to develop a pre-processing tool to generate a TRACE model (input deck) directly from a solid model constructed in SolidWorks software.
This project is part of the outstanding research activity in LRS at PSI whose long-term goal is to be able to generate a TRACE input model of a complex plant in 3-Dimension directly out of CAD model.
This CAD (solid) model is usually constructed with higher fidelity from the available drawing.
The currently available, but disconnected scripting tools written in VBA (Visual Basic for Application, VBA) from previous activities are consolidated and written using fully-featured programming language of Visual Basic .NET.
The tool is also implemented as an object-oriented program to ease further development to extend its capabilities.
At the present stage however, the aim is simply to have a working version for the development of a simple reflood facility model, a 1-dimensional (axial).

\section{Current state of work}

The current state of research during the year are summarized in 
Table~\ref{tab:currentstate} shown below.

\begin{table}[!h]
\caption{Current state of research in relation to the previously submitted
         (1\textsuperscript{st} year) work plan
         }
\centering
\label{tab:currentstate}
\scalebox{0.67}{
\begin{tabularx}{\textwidth}{@{} c Y Y Y @{}} % use 'Y' for first column
% Header ----------------------------------------------------------------------
    \toprule
    \textbf{Phase}
 & \textbf{Task Description}
 & \textbf{Planned Outcome}
 & \textbf{Current State of Work} \\ \midrule
% Table Elements --------------------------------------------------------------
   \multirow{5}{*}{\textbf{1}}                                %Phase
 & Comprehensive reviews of post-CHF flow closure             %Task Description
   laws in TRACE and externalization of important
   model parameters
 & 1 Technical Report (PSI)                                   %Planned Outcome
 & 1. Important reflood model parameters externalized         %Current State
   2. PSI contribution to OECD/NEA PREMIUM Benchmark finalized  \\ \midrule
%
   \multirow{8}{*}{\textbf{2}}                                %Phase
 & Global sensitivity analysis of important                   %Task Description
   based on FEBA test facility
 & 1 Technical Report (PSI) \& 1 Journal Article              %Planned Outcome
 & 1. A paper on Morris screening method for NUTHOS-10        %Current State
   2. Another paper on an application of functional data
      analysis for NUTHOS-10
   3. One abstract on global sensitivity analysis
      method submitted to NURETH-16      \\ \midrule
%
   \multirow{5}{*}{\textbf{3}}                                %Phase
 & Definition of error and specification of                   %Task Description
   probabilistic error model; Calibration of TRACE 
   reflood model based on the FEBA facility;
   Approximation of the posterior distribution by 
   Markov-Chain Monte Carlo; 
 & 1 Technical Report (PSI) \& 1 Journal Article              %Planned Outcome
 & $-$ \\ \midrule                                            %Current State
%
   \multirow{6}{*}{\textbf{4}}                                %Phase
 & Calibration of TRACE reflood model based on another        %Task Description
   reflood test facility
 & 1 Conference Paper                                         %Planned Outcome
 & Possible candidates of reflood facility with adequate      %Current State
   specification and
   experimental data are available (\textit{e.g.,}
   SEFLEX, NEPTUN, ACHILLES) \\ \midrule
%
   \multirow{4}{*}{\textbf{5}}                                %Phase
 & Consolidation of the calibration results based on 2        %Task Description
   facilities and validation based on another reflood
   test facility
 & 1 Journal Article                                          %Planned Outcome
 & $-$  \\\midrule                                            %Current State
%
   \textbf{6}                                                 %Phase
 & Thesis write-up                                            %Task Description
 & Thesis                                                     %Planned Outcome
 & $-$ \\                                                     %Current State
 \bottomrule
\end{tabularx}
}
\end{table}

\section{Calendar of upcoming work}

\section{Other activities and remarks}

\subsection{Nuclear Computation Lab (ETH-531)}

\section{Scientific publications, conference contributions, and presentations}

\nocite{Wicaksono2014a}
\nocite{Wicaksono2014b}
\nocite{Wicaksono2015a}
\nocite{Wicaksono2015b}
\nocite{Wicaksono2015c}

\printbibliography[heading=none]

%% Signature Page
%\newpage
%%\textcolor{white}.\\\\
%\noindent\textbf{Comments by the thesis advisor(s)}\\\\
%\noindent\textbf{Prof. A Pautz}\\\\
%............................................................................
%............................................................................\\\
%............................................................................
%............................................................................\\\
%............................................................................
%............................................................................\\\
%............................................................................
%............................................................................\\\
%............................................................................
%............................................................................\\\
%............................................................................
%............................................................................\\\
%............................................................................
%............................................................................\\\
%............................................................................
%............................................................................\\\
%............................................................................
%............................................................................\\\
%
%\noindent\textbf{O. Zerkak}\\\\
%\noindent Damar can be credited with a prolific and promising first phase of his research 
%project. 
%Despite unavoidable initial difficulties, Damar could assimilate the 
%topic and rapidly become independent.
%He proposed a solution approach of his own, that he will need to implement and 
%test for the reflood problem next year.
%His approach of combining FDA with a solution method for Bayesian inference 
%problem (such as Markov Chain Monte Carlo sampling) is very original in 
%the nuclear engineering field.
%I should also add that Damar has proved very reliable in executing PSI 
%contribution to the OECD/NEA PREMIUM project.
%
%\section*{\underline{Signatures}\\}
%\noindent \textbf{Thesis advisor}\hspace{6.25cm}\dotfill\vspace{0.5cm}\\
%
%\noindent \textbf{Thesis co-advisor}\hspace{5.7cm}\dotfill\\
%\noindent  (if officially nominated)\\\\
%
%\noindent \textbf{With his signature, the candidate confirms that he took note 
%                  of the above comments.}\\\\
%
%\noindent \textbf{Candidate}\hspace{7cm}\dotfill\vspace{0.5cm}\\
%
%\noindent \textbf{Date}\hspace{8.05cm}\dotfill\\
%
%\vspace{0.8cm}
%%\begin{center}
%%\textbf{Up to 5 pages in total}
%%\end{center}
%\begin{center}
%\textbf{To be returned to:} \textcolor{green}{EPFL-EDPY / Station 3 
%                                              / 1015 Lausanne / Suisse}
%\end{center}

% Directly attached signed form
%\includepdf[pages={1}]{figures/Planned-Signed-ZO41.pdf}

\end{document}
